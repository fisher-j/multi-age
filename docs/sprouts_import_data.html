<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Redwoood multi-age experiment - 6&nbsp; Data import and description</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./work_log.html" rel="next">
<link href="./hypothesis_test.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sprouts_import_data.html">Sprouts</a></li><li class="breadcrumb-item"><a href="./sprouts_import_data.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data import and description</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Redwoood multi-age experiment</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Fuels</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_description.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data description</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calculate_fuel_loading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Calculate fuel loading</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fuel_data_exploration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fuel data exploration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hypothesis_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Hypothesis testing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Sprouts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sprouts_import_data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data import and description</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./work_log.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Work log</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#import" id="toc-import" class="nav-link active" data-scroll-target="#import"><span class="header-section-number">6.1</span> Import</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives"><span class="header-section-number">6.2</span> Objectives</a></li>
  <li><a href="#visualize-data" id="toc-visualize-data" class="nav-link" data-scroll-target="#visualize-data"><span class="header-section-number">6.3</span> Visualize data</a>
  <ul>
  <li><a href="#tree-heights" id="toc-tree-heights" class="nav-link" data-scroll-target="#tree-heights"><span class="header-section-number">6.3.1</span> Tree heights</a>
  <ul class="collapse">
  <li><a href="#speciestreatmentyear" id="toc-speciestreatmentyear" class="nav-link" data-scroll-target="#speciestreatmentyear"><span class="header-section-number">6.3.1.1</span> Species/treatment/year</a></li>
  <li><a href="#speciesyearsdi" id="toc-speciesyearsdi" class="nav-link" data-scroll-target="#speciesyearsdi"><span class="header-section-number">6.3.1.2</span> Species/year/SDI</a></li>
  <li><a href="#speciessiteplots" id="toc-speciessiteplots" class="nav-link" data-scroll-target="#speciessiteplots"><span class="header-section-number">6.3.1.3</span> Species/site/plots</a></li>
  </ul></li>
  <li><a href="#height-increments" id="toc-height-increments" class="nav-link" data-scroll-target="#height-increments"><span class="header-section-number">6.3.2</span> Height increments</a></li>
  </ul></li>
  <li><a href="#nesting" id="toc-nesting" class="nav-link" data-scroll-target="#nesting"><span class="header-section-number">6.4</span> Nesting</a></li>
  <li><a href="#modeling" id="toc-modeling" class="nav-link" data-scroll-target="#modeling"><span class="header-section-number">6.5</span> Modeling</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data import and description</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!--
source(knitr::purl("sprouts_import_data.qmd", tempfile()))
-->
<section id="import" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="import"><span class="header-section-number">6.1</span> Import</h2>
<p>First, we’ll load some libraries and our data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>(<span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(tidyverse)))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggokabeito)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>sprouts <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"../data/Sprouts10yr.xlsx"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">743</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_sample</span>(sprouts, <span class="at">n =</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Site</th>
<th style="text-align: right;">Plot</th>
<th style="text-align: left;">Trtmt</th>
<th style="text-align: right;">Tree</th>
<th style="text-align: left;">Species</th>
<th style="text-align: right;">HT1yr_m</th>
<th style="text-align: right;">HT5yr_m</th>
<th style="text-align: right;">HT10yr_m</th>
<th style="text-align: right;">HTI1-5yr</th>
<th style="text-align: right;">HTI5-10yr</th>
<th style="text-align: right;">DBH10yr_cm</th>
<th style="text-align: right;">LCBH10yr</th>
<th style="text-align: right;">CR10yr</th>
<th style="text-align: right;">HD10yr</th>
<th style="text-align: right;">SDIinit</th>
<th style="text-align: right;">AggregatedYN</th>
<th style="text-align: right;">ResidRWonClumpYN</th>
<th style="text-align: right;">HT10rank</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Waldo North</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">GS</td>
<td style="text-align: right;">285</td>
<td style="text-align: left;">LIDE</td>
<td style="text-align: right;">1.72</td>
<td style="text-align: right;">3.55</td>
<td style="text-align: right;">6.30</td>
<td style="text-align: right;">0.4575</td>
<td style="text-align: right;">0.550</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Waldo South</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">GS</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">SESE</td>
<td style="text-align: right;">1.14</td>
<td style="text-align: right;">3.11</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">0.4925</td>
<td style="text-align: right;">0.578</td>
<td style="text-align: right;">6.6</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.900000</td>
<td style="text-align: right;">90.90909</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Whiskey Springs</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">HA</td>
<td style="text-align: right;">1904</td>
<td style="text-align: left;">LIDE</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">1.94</td>
<td style="text-align: right;">0.1675</td>
<td style="text-align: right;">0.196</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">536.33</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="even">
<td style="text-align: left;">Whiskey Springs</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">HD</td>
<td style="text-align: right;">1405</td>
<td style="text-align: left;">SESE</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">5.21</td>
<td style="text-align: right;">9.20</td>
<td style="text-align: right;">0.8450</td>
<td style="text-align: right;">0.798</td>
<td style="text-align: right;">12.5</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.998913</td>
<td style="text-align: right;">73.60000</td>
<td style="text-align: right;">509.90</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The data is in a wide format, variables are as follows:</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-variable-descriptions" class="anchored">
<table class="table table-sm table-striped small">
<caption>Table&nbsp;6.1: Descriptions of variables in dataset.</caption>
<colgroup>
<col style="width: 6%">
<col style="width: 93%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Site</td>
<td style="text-align: left;">One of four sites where treatments were replicated. Sites were located on similar slope positions, but across a range of aspects.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Plot</td>
<td style="text-align: left;">There were 4 plots at each site and each was randomly assigned a treatment</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trtmt</td>
<td style="text-align: left;">Treatemnt type: GS = group selection, which is basically a small clearing, LD = low density–fewer trees remaining; HD = high density–more trees remain and they are dispersed; HA = high density aggregated–more trees remain and they are grouped into clumps.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tree</td>
<td style="text-align: left;">Unique sprout ID within Site, Plot, and Species</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Species</td>
<td style="text-align: left;">SESE = coast redwood, and LIDE = tanoak.</td>
</tr>
<tr class="even">
<td style="text-align: left;">HT1yr_m</td>
<td style="text-align: left;">Sprout height one year after treatment.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HT5yr_m</td>
<td style="text-align: left;">Same as above, but for year 5</td>
</tr>
<tr class="even">
<td style="text-align: left;">HT10yr_m</td>
<td style="text-align: left;">Same as above, but for year 10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HTI1-5yr</td>
<td style="text-align: left;">Height growth between years 1 and 5, (4 growth periods)</td>
</tr>
<tr class="even">
<td style="text-align: left;">HTI5-10yr</td>
<td style="text-align: left;">Height growth between years 5 and 10 (5 growth periods)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DBH10yr_cm</td>
<td style="text-align: left;">Diameter at breast height in cm at year 10. Only collected for redwood</td>
</tr>
<tr class="even">
<td style="text-align: left;">LCBH10yr</td>
<td style="text-align: left;">Live crown base height (height to first live branch) at year 10. Only collected for redwood.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CR10yr</td>
<td style="text-align: left;">Crown ratio (live crown length / total height) at year 10, only for redwood</td>
</tr>
<tr class="even">
<td style="text-align: left;">HD10yr</td>
<td style="text-align: left;">Unknown.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SDIinit</td>
<td style="text-align: left;">Stand density index of plot immediately after treatment.</td>
</tr>
<tr class="even">
<td style="text-align: left;">AggregatedYN</td>
<td style="text-align: left;">Indicator for treatment HA.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ResidRWonClumpYN</td>
<td style="text-align: left;">Unknown.</td>
</tr>
<tr class="even">
<td style="text-align: left;">HT10rank</td>
<td style="text-align: left;">Trees species specific height ranking within plot.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>I’m going to change some variable names to make them more ergonomic</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>newnames <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">site =</span> <span class="st">"Site"</span>, <span class="at">plot =</span> <span class="st">"Plot"</span>, <span class="at">treat =</span> <span class="st">"Trtmt"</span>, <span class="at">tree =</span> <span class="st">"Tree"</span>, <span class="at">spp =</span> <span class="st">"Species"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ht1 =</span> <span class="st">"HT1yr_m"</span>, <span class="at">ht5 =</span> <span class="st">"HT5yr_m"</span>, <span class="at">ht10 =</span> <span class="st">"HT10yr_m"</span>, <span class="at">ht_inc5 =</span> <span class="st">"HTI1-5yr"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ht_inc10 =</span> <span class="st">"HTI5-10yr"</span>, <span class="at">dbh10 =</span> <span class="st">"DBH10yr_cm"</span>, <span class="at">lcbh10 =</span> <span class="st">"LCBH10yr"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sdi_init =</span> <span class="st">"SDIinit"</span>, <span class="at">agg =</span> <span class="st">"AggregatedYN"</span>, <span class="at">ht_rnk10 =</span> <span class="st">"HT10rank"</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">old =</span> newnames, <span class="at">new =</span> <span class="fu">names</span>(newnames)) <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">old</th>
<th style="text-align: left;">new</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Site</td>
<td style="text-align: left;">site</td>
</tr>
<tr class="even">
<td style="text-align: left;">Plot</td>
<td style="text-align: left;">plot</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trtmt</td>
<td style="text-align: left;">treat</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tree</td>
<td style="text-align: left;">tree</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Species</td>
<td style="text-align: left;">spp</td>
</tr>
<tr class="even">
<td style="text-align: left;">HT1yr_m</td>
<td style="text-align: left;">ht1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HT5yr_m</td>
<td style="text-align: left;">ht5</td>
</tr>
<tr class="even">
<td style="text-align: left;">HT10yr_m</td>
<td style="text-align: left;">ht10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HTI1-5yr</td>
<td style="text-align: left;">ht_inc5</td>
</tr>
<tr class="even">
<td style="text-align: left;">HTI5-10yr</td>
<td style="text-align: left;">ht_inc10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DBH10yr_cm</td>
<td style="text-align: left;">dbh10</td>
</tr>
<tr class="even">
<td style="text-align: left;">LCBH10yr</td>
<td style="text-align: left;">lcbh10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SDIinit</td>
<td style="text-align: left;">sdi_init</td>
</tr>
<tr class="even">
<td style="text-align: left;">AggregatedYN</td>
<td style="text-align: left;">agg</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HT10rank</td>
<td style="text-align: left;">ht_rnk10</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>sprouts <span class="ot">&lt;-</span> <span class="fu">select</span>(sprouts, <span class="fu">all_of</span>(newnames))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>treat_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"GS"</span>, <span class="st">"LD"</span>, <span class="st">"HA"</span>, <span class="st">"HD"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="objectives" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="objectives"><span class="header-section-number">6.2</span> Objectives</h2>
<p>Our main objectives are to:</p>
<ul>
<li>Test for treatment effects on redwood height and diameter at year 10 and in comparison to other years</li>
<li>Explore treatment effect on competition between redwood and tanoak</li>
<li>Produce a model for sapling height at year 10 as a funtion of harvest intensity (initial SDI)</li>
<li>Explore differences in height increment over multiple remeasurements</li>
</ul>
</section>
<section id="visualize-data" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="visualize-data"><span class="header-section-number">6.3</span> Visualize data</h2>
<section id="tree-heights" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="tree-heights"><span class="header-section-number">6.3.1</span> Tree heights</h3>
<p>The following figures reveal possible trends in the raw data.</p>
<section id="speciestreatmentyear" class="level4" data-number="6.3.1.1">
<h4 data-number="6.3.1.1" class="anchored" data-anchor-id="speciestreatmentyear"><span class="header-section-number">6.3.1.1</span> Species/treatment/year</h4>
<p><a href="#fig-data-summary-treatments">Figure&nbsp;<span>6.1</span></a> reveals fine, species specific differences between treatments and general trends over time. It shows that over time, LD and GS treatments have more taller trees than the other treatments, with GS having the most. This is true for both redwood and tanoak. Additionaly, for redwood it appears that HA may have taller trees than HD, at least in year 10.</p>
<p><a href="#fig-data-summary-spp">Figure&nbsp;<span>6.2</span></a> shows the same information as before, but is arguably more easier to look at. There is a generall increasing trend in heights as follows:</p>
<pre><code>HD &lt; HA &lt; LD &lt; GS</code></pre>
<p>seems to suggest that redwood are taller across all treatments and years, but the GS treatment is the only one that provides a clear advantage to redwood.</p>
<p>Across all treatments, it is also interesting to note that over times, the height distributions, especially for redwood, seem to becoming more multi-modal and more widely distributed. This could be due to site or plot effects, or to microsite (within plot) effects, but it is not immediately clear why this diverging performance should be so apparent with redwood and not tanoak.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to convert heights or increments from multiple years to long format</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># to facilitate analysis and plotting of that variable</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>lengthen_data <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var) {</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  pref <span class="ot">&lt;-</span> <span class="cf">switch</span>(var, <span class="at">ht =</span> <span class="st">"(ht)"</span>, <span class="at">ht_inc =</span> <span class="st">"(ht_inc)"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  suf <span class="ot">&lt;-</span> <span class="st">"(</span><span class="sc">\\</span><span class="st">d+)"</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  str_to_match <span class="ot">&lt;-</span> <span class="fu">paste0</span>(pref, suf)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(data,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">matches</span>(str_to_match),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">".value"</span>, <span class="st">"year"</span>),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_pattern =</span> str_to_match,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">year =</span> as.integer)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(year, <span class="fu">matches</span>(<span class="fu">paste0</span>(pref, <span class="st">"$"</span>)), <span class="at">.after =</span> spp)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>sprouts <span class="sc">|&gt;</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lengthen_data</span>(<span class="st">"ht"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ht, <span class="fu">fct_rev</span>(<span class="fu">factor</span>(year)), <span class="at">color =</span> treat)) <span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">alpha =</span> .<span class="dv">3</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>spp) <span class="sc">+</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (m)"</span>, <span class="at">y =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-data-summary-treatments" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="sprouts_import_data_files/figure-html/fig-data-summary-treatments-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption class="figure-caption">Figure&nbsp;6.1: Height distributions for tanoak and redwood over time for each of four treatments. Treatments GS and LD have higher proportions of taller trees. Years refers to number of years after treatment.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sprouts <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lengthen_data</span>(<span class="st">"ht"</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> ht,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">fct_relevel</span>(treat, treat_order),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">factor</span>(spp, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"SESE"</span>, <span class="st">"LIDE"</span>))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>(<span class="at">alpha =</span> .<span class="dv">3</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(year <span class="sc">~</span> ., <span class="at">labeller =</span> label_both) <span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Height (m)"</span>, <span class="at">y =</span> <span class="st">"Treatment"</span>) <span class="sc">+</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>, <span class="at">name =</span> <span class="st">"Species"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-data-summary-spp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="sprouts_import_data_files/figure-html/fig-data-summary-spp-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;6.2: Similar to <a href="#fig-data-summary-treatments">Figure&nbsp;<span>6.1</span></a>, but with an emphasis on differences between speceis responses across treatments. Comparisons are made for each year. The GS treatment appears to favor redwood response the most, but all treatments show redwoods are taller than tanoak. Years refers to number of years after treatment.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="speciesyearsdi" class="level4" data-number="6.3.1.2">
<h4 data-number="6.3.1.2" class="anchored" data-anchor-id="speciesyearsdi"><span class="header-section-number">6.3.1.2</span> Species/year/SDI</h4>
<p><a href="#fig-data-summary-sdi">Figure&nbsp;<span>6.3</span></a> shows that above around 400 SDI, tree heights level off. It also implies a steady decrease in height from 0 to around 400 SDI. The strength of the relationship appears to be increasing over time, particularly for redwood.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sprouts <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lengthen_data</span>(<span class="st">"ht"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sdi_init, ht, <span class="at">color =</span> <span class="fu">factor</span>(year))) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>spp) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-data-summary-sdi" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="sprouts_import_data_files/figure-html/fig-data-summary-sdi-1.png" class="img-fluid figure-img" width="816"></p>
<figcaption class="figure-caption">Figure&nbsp;6.3: SDI vs HT for both species, across measurement years.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="speciessiteplots" class="level4" data-number="6.3.1.3">
<h4 data-number="6.3.1.3" class="anchored" data-anchor-id="speciessiteplots"><span class="header-section-number">6.3.1.3</span> Species/site/plots</h4>
<p>Lets see what the variability among sites and plots looks like, I’ll focus on year 10 only.</p>
<p><a href="#fig-data-summary-sites">Figure&nbsp;<span>6.4</span></a> reveals some differences between sites, particularly for redwoods. Waldo North tends to have larger redwoods and Camp 6 has a large proportion of smaller redwoods.</p>
<p>We can see in <a href="#fig-data-summary-plots">Figure&nbsp;<span>6.5</span></a> that there seems to be differences among plots beyond site differences and treatment differences. We should expect plots to capture a portion of the variance. Most notable is the plot level difference between redwood and tanoak. For redwood, the large ammount of within plot variability combined with the between plot variability obscures the treatment effect. If you squint, there appears to be a similar overall pattern between redwood and tanoak repsonse to treatment, but it appears they respond differentially to certain plots.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(ggdist))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>sprouts <span class="sc">|&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ht10, site, <span class="at">fill =</span> spp)) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slab</span>(<span class="fu">aes</span>(<span class="at">thickness =</span> <span class="fu">after_stat</span>(pdf <span class="sc">*</span> n)), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">scale =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">side =</span> <span class="st">"bottom"</span>, <span class="at">scale =</span> <span class="fl">0.7</span>, <span class="at">slab_color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"year 10 height (m)"</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="st">"species"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-data-summary-sites" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="sprouts_import_data_files/figure-html/fig-data-summary-sites-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;6.4: Distribution of heights at year 10 at each site for two species. Slabs are normalized by sample size to reflect the raw data, plotted as dots below.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sprouts <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    ht10,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">interaction</span>(site, <span class="fu">fct_relevel</span>(treat, treat_order), <span class="at">sep =</span> <span class="st">" - "</span>),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">fct_relevel</span>(treat, treat_order),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slab</span>(<span class="fu">aes</span>(<span class="at">thickness =</span> <span class="fu">after_stat</span>(pdf <span class="sc">*</span> n)), <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">scale =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dotsinterval</span>(<span class="at">side =</span> <span class="st">"bottom"</span>, <span class="at">scale =</span> <span class="fl">0.7</span>, <span class="at">slab_color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>spp) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">x =</span> <span class="st">"year 10 height (m)"</span>, <span class="at">fill =</span> <span class="st">"treatment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-data-summary-plots" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="sprouts_import_data_files/figure-html/fig-data-summary-plots-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;6.5: Same as for <a href="#fig-data-summary-sites">Figure&nbsp;<span>6.4</span></a>, but for each plot (Site/treatment interaction). Grouped by treatment.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="height-increments" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2" class="anchored" data-anchor-id="height-increments"><span class="header-section-number">6.3.2</span> Height increments</h3>
<p>Height increments contain similar information as heights, but allow us to compare directly between years.</p>
<p><a href="#fig-data-summary-ht-inc-year">Figure&nbsp;<span>6.6</span></a> shows that across treatments and species, height growth slows down in the second period (years 5-10). This is more true for redwood but it starts with more rapid growth than tanoak. In the most crowded treatment (HD), redwoods height increment has become slower than tanoaks in the second period. Also, in the second period, the high density, aggregated treatment appears to have slightly higher (or equal) average growth increment, which is not completely expected.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sprouts <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lengthen_data</span>(<span class="st">"ht_inc"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>      ht_inc,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fct_relevel</span>(treat, treat_order),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="fu">factor</span>(year),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="fu">factor</span>(year)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slab</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_pointinterval</span>(</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>spp) <span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Year"</span>,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Year"</span>,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Treatment"</span>,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">expression</span>(Height<span class="sc">~</span>increment<span class="sc">~</span>(m<span class="sc">~</span>yr<span class="sc">^-</span><span class="dv">1</span>))</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">rnd_color_brewer</span>(<span class="st">"Set2"</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)),</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">aesthetics =</span> <span class="fu">c</span>(<span class="st">"color"</span>, <span class="st">"fill"</span>)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 4</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-data-summary-ht-inc-year" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="sprouts_import_data_files/figure-html/fig-data-summary-ht-inc-year-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;6.6: Variations in annual height growth increment between the first and second measurement periods (years 1-5, and 5-10, respectively).</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="nesting" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="nesting"><span class="header-section-number">6.4</span> Nesting</h2>
<p>Our data though are nested, we have:</p>
<pre><code>Sites
└─ Plots
   └─ Trees
      └─ Observations</code></pre>
<p>Each Treatment is represented by one site/plot combination. Each site belongs to each treatment and vice versa. I think the terminology here is that Sites and treatments are crossed.</p>
<p>Currently, <code>plot</code> is only unique within <code>site</code> and <code>tree</code> is only unique within <code>site</code>, <code>treat</code>, and <code>spp</code>. It will be more convenient if <code>plot</code> and <code>tree</code> are globally unique identifiers. This makes the nesting structure implicit, and we can simplify our model syntax.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>implicit_grouping <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">|&gt;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">plot =</span> <span class="fu">cur_group_id</span>(), <span class="at">.by =</span> <span class="fu">c</span>(site, treat)) <span class="sc">|&gt;</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Tree =</span> <span class="fu">row_number</span>())</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> sprouts <span class="sc">|&gt;</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">implicit_grouping</span>() <span class="sc">|&gt;</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lengthen_data</span>(<span class="st">"ht"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="modeling" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="modeling"><span class="header-section-number">6.5</span> Modeling</h2>
<p>In addition to characterizing redwood growth response, we would also like to accurately describe differences between redwood and tanoak. This is probably best accomplished by including species in the model, and modeling the difference directly.</p>
<p>because of our multiple grouping variables, model complexity can grow quickly, especially when considering how covariates interact with grouping variables, which lead to random slope models</p>
<p>I’m also wondering what it means to include a categorical variable as a random slope (on the LHS of the random parts). Michael Clark <a href="https://m-clark.github.io/posts/2020-03-01-random-categorical">explores this scenario</a>, with some simpler data.</p>
<p>In any case, following the pattern of data summaries above, I’ll start by modeling to detect treatment differences in tree height.</p>
<p>I’ll start with the simplest model that I’m willing to look at: a treatment/species interaction for only year 10. This model is not that bad, the residuals indicate some heteroskedasticity. It has a moderate r-squared (0.55). It doesn’t account for non-independence due to nesting structure of our data though.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ht <span class="sc">~</span> treat <span class="sc">*</span> spp, <span class="at">data =</span> <span class="fu">filter</span>(d, year <span class="sc">==</span> <span class="dv">10</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(m1), <span class="fu">resid</span>(m1)); <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="sprouts_import_data_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>How do the other measurement years compare.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>), </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  \(x) <span class="fu">lm</span>(ht <span class="sc">~</span> treat <span class="sc">*</span> spp, <span class="at">data =</span> <span class="fu">filter</span>(d, year <span class="sc">==</span> x))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(ms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">&nbsp;(1)</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">&nbsp;&nbsp;(2)</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">&nbsp;&nbsp;(3)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">0.984</td>
<td style="text-align: center;">2.980</td>
<td style="text-align: center;">5.235</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">(0.053)</td>
<td style="text-align: center;">(0.125)</td>
<td style="text-align: center;">(0.228)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">treatHA</td>
<td style="text-align: center;">−0.537</td>
<td style="text-align: center;">−1.221</td>
<td style="text-align: center;">−2.055</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">(0.075)</td>
<td style="text-align: center;">(0.176)</td>
<td style="text-align: center;">(0.320)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">treatHD</td>
<td style="text-align: center;">−0.513</td>
<td style="text-align: center;">−1.239</td>
<td style="text-align: center;">−2.087</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">(0.075)</td>
<td style="text-align: center;">(0.177)</td>
<td style="text-align: center;">(0.322)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">treatLD</td>
<td style="text-align: center;">−0.446</td>
<td style="text-align: center;">−0.809</td>
<td style="text-align: center;">−1.214</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">(0.079)</td>
<td style="text-align: center;">(0.185)</td>
<td style="text-align: center;">(0.337)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sppSESE</td>
<td style="text-align: center;">0.964</td>
<td style="text-align: center;">3.138</td>
<td style="text-align: center;">5.308</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">(0.076)</td>
<td style="text-align: center;">(0.178)</td>
<td style="text-align: center;">(0.324)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">treatHA × sppSESE</td>
<td style="text-align: center;">−0.182</td>
<td style="text-align: center;">−1.006</td>
<td style="text-align: center;">−1.589</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">(0.107)</td>
<td style="text-align: center;">(0.252)</td>
<td style="text-align: center;">(0.459)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">treatHD × sppSESE</td>
<td style="text-align: center;">−0.455</td>
<td style="text-align: center;">−1.457</td>
<td style="text-align: center;">−2.564</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">(0.108)</td>
<td style="text-align: center;">(0.254)</td>
<td style="text-align: center;">(0.462)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">treatLD × sppSESE</td>
<td style="text-align: center;">−0.419</td>
<td style="text-align: center;">−0.748</td>
<td style="text-align: center;">−1.253</td>
</tr>
<tr class="even">
<td style="text-align: left; box-shadow: 0px 1.5px;"></td>
<td style="text-align: center; box-shadow: 0px 1.5px;">(0.113)</td>
<td style="text-align: center; box-shadow: 0px 1.5px;">(0.265)</td>
<td style="text-align: center; box-shadow: 0px 1.5px;">(0.483)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Num.Obs.</td>
<td style="text-align: center;">692</td>
<td style="text-align: center;">692</td>
<td style="text-align: center;">692</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: center;">0.467</td>
<td style="text-align: center;">0.591</td>
<td style="text-align: center;">0.556</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R2 Adj.</td>
<td style="text-align: center;">0.462</td>
<td style="text-align: center;">0.587</td>
<td style="text-align: center;">0.551</td>
</tr>
<tr class="even">
<td style="text-align: left;">AIC</td>
<td style="text-align: center;">1047.4</td>
<td style="text-align: center;">2228.4</td>
<td style="text-align: center;">3059.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BIC</td>
<td style="text-align: center;">1088.2</td>
<td style="text-align: center;">2269.2</td>
<td style="text-align: center;">3100.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Log.Lik.</td>
<td style="text-align: center;">−514.685</td>
<td style="text-align: center;">−1105.176</td>
<td style="text-align: center;">−1520.613</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RMSE</td>
<td style="text-align: center;">0.51</td>
<td style="text-align: center;">1.19</td>
<td style="text-align: center;">2.18</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  ht <span class="sc">~</span> <span class="fu">scale</span>(sdi_init) <span class="sc">*</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(year) <span class="sc">*</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    spp <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> site) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> plot) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> tree),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  ht <span class="sc">~</span> <span class="fu">scale</span>(sdi_init) <span class="sc">*</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(year) <span class="sc">*</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    spp <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    (spp <span class="sc">|</span> site) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    (spp <span class="sc">|</span> plot) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    (spp <span class="sc">|</span> tree),</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: ht ~ scale(sdi_init) * factor(year) * spp + (1 | site) + (1 |  
    plot) + (1 | tree)
   Data: d

REML criterion at convergence: 7079.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.4430 -0.4175  0.0258  0.4153  3.8479 

Random effects:
 Groups   Name        Variance  Std.Dev. 
 tree     (Intercept) 7.147e-01 0.8454101
 plot     (Intercept) 3.391e-01 0.5823463
 site     (Intercept) 9.305e-10 0.0000305
 Residual             1.350e+00 1.1618203
Number of obs: 2076, groups:  tree, 454; plot, 16; site, 4

Fixed effects:
                                       Estimate Std. Error t value
(Intercept)                             0.65409    0.16908   3.869
scale(sdi_init)                        -0.23624    0.16471  -1.434
factor(year)5                           1.55167    0.08685  17.866
factor(year)10                          3.28350    0.08685  37.806
sppSESE                                 0.63877    0.09738   6.560
scale(sdi_init):factor(year)5          -0.30080    0.08734  -3.444
scale(sdi_init):factor(year)10         -0.66704    0.08734  -7.637
scale(sdi_init):sppSESE                -0.15411    0.09662  -1.595
factor(year)5:sppSESE                   1.62900    0.12502  13.030
factor(year)10:sppSESE                  3.25279    0.12502  26.019
scale(sdi_init):factor(year)5:sppSESE  -0.37713    0.12501  -3.017
scale(sdi_init):factor(year)10:sppSESE -0.72215    0.12501  -5.777

Correlation of Fixed Effects:
            (Intr) scl(_) fct()5 fc()10 spSESE sc(_):()5 sc(_):()10 s(_):S
scal(sd_nt) -0.026                                                        
factor(yr)5 -0.257  0.005                                                 
factr(yr)10 -0.257  0.005  0.500                                          
sppSESE     -0.277 -0.004  0.446  0.446                                   
scl(s_):()5  0.005 -0.265 -0.018 -0.009 -0.008                            
scl(_):()10  0.005 -0.265 -0.009 -0.018 -0.008  0.500                     
scl(_):SESE -0.011 -0.287 -0.008 -0.008  0.049  0.452     0.452           
fct()5:SESE  0.178 -0.003 -0.695 -0.347 -0.642  0.012     0.006     -0.001
fc()10:SESE  0.178 -0.003 -0.347 -0.695 -0.642  0.006     0.012     -0.001
s(_):()5:SE -0.003  0.185  0.012  0.006 -0.001 -0.699    -0.349     -0.647
s(_):()10:S -0.003  0.185  0.006  0.012 -0.001 -0.349    -0.699     -0.647
            f()5:S f()10: s(_):()5:
scal(sd_nt)                        
factor(yr)5                        
factr(yr)10                        
sppSESE                            
scl(s_):()5                        
scl(_):()10                        
scl(_):SESE                        
fct()5:SESE                        
fc()10:SESE  0.500                 
s(_):()5:SE  0.001  0.001          
s(_):()10:S  0.001  0.001  0.500   
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: ht ~ scale(sdi_init) * factor(year) * spp + (spp | site) + (spp |  
    plot) + (spp | tree)
   Data: d

REML criterion at convergence: 6747.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.1193 -0.4451  0.0031  0.4324  3.5951 

Random effects:
 Groups   Name        Variance Std.Dev. Corr
 tree     (Intercept) 0.0000   0.0000       
          sppSESE     1.3887   1.1784    NaN
 plot     (Intercept) 0.1750   0.4183       
          sppSESE     0.3809   0.6172   0.38
 site     (Intercept) 0.0000   0.0000       
          sppSESE     0.3935   0.6273    NaN
 Residual             1.1823   1.0873       
Number of obs: 2076, groups:  tree, 454; plot, 16; site, 4

Fixed effects:
                                       Estimate Std. Error t value
(Intercept)                             0.59454    0.11943   4.978
scale(sdi_init)                        -0.21946    0.12178  -1.802
factor(year)5                           1.55167    0.08128  19.089
factor(year)10                          3.28350    0.08128  40.395
sppSESE                                 0.76986    0.37033   2.079
scale(sdi_init):factor(year)5          -0.30080    0.08174  -3.680
scale(sdi_init):factor(year)10         -0.66704    0.08174  -8.160
scale(sdi_init):sppSESE                -0.12308    0.18630  -0.661
factor(year)5:sppSESE                   1.62900    0.11700  13.923
factor(year)10:sppSESE                  3.25279    0.11700  27.801
scale(sdi_init):factor(year)5:sppSESE  -0.37713    0.11699  -3.224
scale(sdi_init):factor(year)10:sppSESE -0.72215    0.11699  -6.173

Correlation of Fixed Effects:
            (Intr) scl(_) fct()5 fc()10 spSESE sc(_):()5 sc(_):()10 s(_):S
scal(sd_nt) -0.008                                                        
factor(yr)5 -0.340  0.006                                                 
factr(yr)10 -0.340  0.006  0.500                                          
sppSESE      0.064  0.000  0.110  0.110                                   
scl(s_):()5  0.006 -0.336 -0.018 -0.009 -0.002                            
scl(_):()10  0.006 -0.336 -0.009 -0.018 -0.002  0.500                     
scl(_):SESE  0.001  0.138 -0.004 -0.004 -0.019  0.219     0.219           
fct()5:SESE  0.236 -0.004 -0.695 -0.347 -0.158  0.012     0.006      0.000
fc()10:SESE  0.236 -0.004 -0.347 -0.695 -0.158  0.006     0.012      0.000
s(_):()5:SE -0.004  0.234  0.012  0.006  0.000 -0.699    -0.349     -0.314
s(_):()10:S -0.004  0.234  0.006  0.012  0.000 -0.349    -0.699     -0.314
            f()5:S f()10: s(_):()5:
scal(sd_nt)                        
factor(yr)5                        
factr(yr)10                        
sppSESE                            
scl(s_):()5                        
scl(_):()10                        
scl(_):SESE                        
fct()5:SESE                        
fc()10:SESE  0.500                 
s(_):()5:SE  0.001  0.001          
s(_):()10:S  0.001  0.001  0.500   
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./hypothesis_test.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Hypothesis testing</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./work_log.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Work log</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>